[comment]: # "File: README.md"
[comment]: # "Copyright (c) 2018-2023 ExtraHop"
[comment]: # ""
[comment]: # "Licensed under the Apache License, Version 2.0 (the 'License');"
[comment]: # "you may not use this file except in compliance with the License."
[comment]: # "You may obtain a copy of the License at"
[comment]: # ""
[comment]: # "    http://www.apache.org/licenses/LICENSE-2.0"
[comment]: # ""
[comment]: # "Unless required by applicable law or agreed to in writing, software distributed under"
[comment]: # "the License is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,"
[comment]: # "either express or implied. See the License for the specific language governing permissions"
[comment]: # "and limitations under the License."
[comment]: # ""
# App Backward Compatibility

This app is not backward compatible with extrahop appliance versions below 9.3.0. Version 9.3.0 or
higher is recommended.

The multiple category support is only compatible with ExtraHop appliance version greater or equal to
9.3.0.

# Integrate ExtraHop Reveal(x)

The Splunk SOAR integration for ExtraHop enables you to automate and orchestrate rapid security
investigation, response, and remediation workflows. ExtraHop Reveal(x) provides a uniquely rich,
real-time data source by turning unstructured packets into structured wire data and analyzing it in
real-time. Based on this data, you can confidently configure Splunk SOAR to automate security
workflows and investigations and orchestrate precise, rapid responses to security threats more
effectively than ever before.

Extrahop and Splunk SOAR connect through simple, powerful REST APIs, making it easy to build and
iterate new use cases to get the most value for the least effort, a vital capability for thinly
stretched enterprise security teams.

-   To integrate ExtraHop Reveal(x) 360, you must first [generate a client ID and client
    secret](https://docs.extrahop.com/current/rx360-integrations-splunk-soar/) from the ExtraHop
    system, and then configure an asset in the ExtraHop App for Splunk SOAR.
-   To integrate ExtraHop Reveal(x) Enterprise, you must first [generate a REST API
    key](https://docs.extrahop.com/current/rest-api-guide/#generate-an-api-key) from the ExtraHop
    system, and then configure an asset in the ExtraHop App for Splunk SOAR.

# Asset settings

The Asset Settings tab of the app enables you to specify settings for integrating Splunk SOAR with
ExtraHop Reveal(x) and to configure the type of ExtraHop data you want to poll.

## Integration settings

-   **Type of asset:** Specify the type of ExtraHop system to be polled. The following are the valid
    values that the parameter can take:  
    -   Reveal(x) Enterprise
    -   Reveal(x) 360
-   **IP address or hostname:** Specify the IP address or hostname of the ExtraHop system to be
    polled. Specify an IP address or hostname for a Reveal(x) Enterprise sensor or console. Specify
    a hostname for a Reveal(x) 360 console.
-   **Extrahop platform URL:** Specify the ExtraHop platform URL. This parameter is only applicable
    for Extrahop Reveal(x) 360. If not provided, then the 'extrahop_link' field will not be added to
    the artifact. For Reveal(x) Enterprise, the platform URL is the same as the IP/hostname provided
    in the asset. And this parameter will only be used in the 'Detections' ingestion type.
-   **REST API Key:** Specify the REST API Key generated by the ExtraHop system. This key is only
    required for Reveal(x) Enterprise.
-   **Client ID:** Specify a client ID. This ID is only required for integrating with Reveal(x) 360.
-   **Client secret:** Specify a client secret. This secret is only required for integrating with
    Reveal(x) 360.
-   **Verify server certificate:** Select to verify the server certificate on the ExtraHop system.
-   **Type of data to retrieve and ingest:** Specify the type of data to be retrieved and ingested
    while polling. The default value is 'Detections'. The following are the valid values that the
    parameter can take:
    -   Detections
    -   Metrics
    -   PCAP
-   **JSON object for on poll:** Specify a JSON request payload to retrieve more data than offered
    by the current parameters. Contents of the JSON payload will overwrite any values set in other
    configuration parameters. See the [ExtraHop REST API
    Guide](https://docs.extrahop.com/current/rest-api-guide/) for formatting guidelines. In JSON
    object, 'from', 'until', 'limit', and 'offset' parameters will not be considered as they are
    internally managed by the on-poll action.

## **Detection settings** 

For detection, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from the past 1 hour.

-   **Detection category:** Specify the category of detections you want to retrieve. Specify a
    comma-delimited list to poll for more than one categories. If left blank, the poll retrieves
    detections of **sec.attack** category. The following are the valid values that the parameter can
    take:
    -   sec
    -   sec.action
    -   sec.attack
    -   sec.botnet
    -   sec.caution
    -   sec.command
    -   sec.cryptomining
    -   sec.dos
    -   sec.exfil
    -   sec.exploit
    -   sec.hardening
    -   sec.ransomware
    -   sec.recon
    -   perf
    -   perf.auth
    -   perf.db
    -   perf.network
    -   perf.service
    -   perf.storage
    -   perf.virtual
    -   perf.web

-   **Detection status:** Specify the status of the detections you want to retrieve. Specify a
    comma-delimited list to poll for more than one status. If left blank, the poll retrieves
    detections of any status. The following are the valid values that the parameter can take:

    -   new
    -   in_progress
    -   closed
    -   acknowledged

    Note: If the detection status is set to "new", the "new" and ".none" detection would be
    ingested.

-   The artifact's severity will be added based on the risk score provided in detection.
    -   Default: low
    -   if risk_score \> 80 then severity is set to high
    -   if risk_score \> 30 then severity is set to medium

-   Based on the description provided in detection, a Splunk SOAR note will be added. It will only
    be added again if the description is updated apart from the timestamp field.

-   **Note:**

    Default detection category will be considered as "sec.attack" in 'json_object' and
    'detection_category' configuration parameters

## **Metric settings** 

For metric, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from the past 1 hour.

-   **Aggregation interval:** Specify the aggregation, or roll-up, time interval for the metric
    cycle. The default value is 'auto' which will retrieve the data according to the time decided by
    api. The following are the valid values that the parameter can take:
    -   auto
    -   30 seconds
    -   5 minutes
    -   1 hour
-   **Object ID:** Specify the comma-delimited IDs of the objects that you want to poll for
    metrics.  
-   **Object type:** Specify the type of object. The default value is 'Applications' which will
    retrieve the data of the appllication object type. The following are the valid values that the
    parameter can take:  
    -   Applications
    -   Device
    -   Device Groups
    -   Device Group Summary
    -   Network
-   **Metrics category:** Specify the category of the metrics you want to retrieve, such as "http"
    or "dns_server". To find the category of a metric, open the Metric Catalog from the ExtraHop
    system. The category is displayed in the REST API Parameters section for each metric.
-   **Metrics name:** Specify the comma-delimited names of a metric you want to retrieve. To find
    the name of a metric, open the Metric Catalog from the ExtraHop system. The name is displayed in
    the REST API Parameters section for the metric.

## **PCAP settings** 

For PCAP, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from past one hour. The packets will only be ingested in the **pcap** file format.

-   **BPF:** Specify the Berkeley Packet Filter syntax you want to apply to the poll. For more
    information about [BPF syntax](https://docs.extrahop.com/8.9/bpf-syntax/) .  
-   **Maximum bytes:** Specify the maximum number of bytes that the poll can return when retrieving
    packets.
-   **Maximum search time:** Specify the maximum amount of time that the poll can run when
    retrieving packets. The default unit is milliseconds, but other units can be specified with a
    unit suffix.  
-   **IP address:** Specify the IP address sending or receiving packets that you want to retrieve.
    You can also specify a second IP address.  
-   **Port:** Specify the port sending or receiving packets that you want to retrieve. You can also
    specify a second port.  

## Asset polling

Polling is the process of retrieving data from an asset and ingesting it into Splunk SOAR. The
parameters specified on the Asset Settings tab of the app determine what data is retrieved.

You can initiate polling manually, on a schedule, or by the interval from the Ingest Settings tab on
the app.

Data is stored in the form of containers and artifacts. A container is a structured JSON object on
which playbook automation APIs are run. An artifact is a JSON object stored in a container and
represents an incident, activity, data, or other item associated with a container. You can add a
label to a container to describe the contents. For example, you might label a container for a type
of detection that contains artifacts for each occurrence of the detection type.

## Playbook Backward Compatibility

-   The parameters have been added in the below-existing action. Hence, it is requested to update
    existing playbooks created in the earlier versions of the app by re-inserting | modifying |
    deleting the corresponding action blocks.

      

    -   Get devices - Below parameters have been added or updated.

          

        -   'json object'
        -   'filter'
        -   Updated name from 'activity type' to 'field type'

    -   Create Device - Below parameters have been added.

          

        -   'json object'
