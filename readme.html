<!--File: readme.html
Copyright (c) 2018-2022 Splunk Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under
the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.
-->
<html>
<head></head>
<body>
	<h1>Integrate ExtraHop Reveal(x)</h1>
	<p>The Splunk SOAR integration for ExtraHop enables you to automate and orchestrate rapid security investigation, response, and remediation workflows. ExtraHop Reveal(x) provides a uniquely rich, real-time data source by turning unstructured packets into structured wire data and analyzing it in real-time. Based on this data, you can confidently configure Splunk SOAR to automate security workflows and investigations and orchestrate precise, rapid responses to security threats more effectively than ever before.</p>
	<p>Extrahop and Splunk SOAR connect through simple, powerful REST APIs, making it easy to build and iterate new use cases to get the most value for the least effort, a vital capability for thinly stretched enterprise security teams.</p>
	<ul>
		<li>To integrate ExtraHop Reveal(x) 360, you must first <a href="https://docs.extrahop.com/current/rx360-integrations-splunk-soar/" target="_blank">generate a client ID and client secret</a> from the ExtraHop system, and then configure an asset in the ExtraHop App for Splunk SOAR.</li>
		<li>To integrate ExtraHop Reveal(x) Enterprise, you must first <a href="https://docs.extrahop.com/current/rest-api-guide/#generate-an-api-key" target="_blank">generate a REST API key</a> from the ExtraHop system, and then configure an asset in the ExtraHop App for Splunk SOAR.
		</li>
	</ul>
	<h1>Asset settings</h1>
	<p>The Asset Settings tab of the app enables you to specify settings for integrating Splunk SOAR with ExtraHop Reveal(x) and to configure the type of ExtraHop data you want to poll.</p>
	<h2>Integration settings</h2>
	<ul>
		<li>
			<b>Type of asset: </b>Specify the type of ExtraHop system to be polled. The following are the valid values that the parameter can take:<br>
			<ul>
				<li>Reveal(x) Enterprise</li>
				<li>Reveal(x) 360</li>
			</ul>
		</li>
		<li><b>IP address or hostname: </b>Specify the IP address or hostname of the ExtraHop system to be polled. Specify an IP address or hostname for a Reveal(x) Enterprise sensor or console. Specify a hostname for a Reveal(x) 360 console.</li>
		<li>
			<b>REST API Key: </b>Specify the REST API Key generated by the ExtraHop system. This key is only required for Reveal(x) Enterprise.
		</li>
		<li>
			<b>Client ID: </b>Specify a client ID. This ID is only required for integrating with Reveal(x) 360.
		</li>
		<li>
			<b>Client secret: </b>Specify a client secret. This secret is only required for integrating with Reveal(x) 360.
		</li>
		<li>
			<b>Verify server certificate: </b>Select to verify the server certificate on the ExtraHop system.
		</li>
		<li>
			<b>Type of data to retrieve and ingest: </b>Specify the type of data to be retrieved and ingested while polling. The default value is 'Detections'. The following are the valid values that the parameter can take:
			<ul>
				<li>Detections</li>
				<li>Metrics</li>
				<li>PCAP</li>
			</ul>
		</li>
		<li>
			<b>JSON object for on poll: </b>Specify a JSON request payload to retrieve more data than offered by the current parameters. Contents of the JSON payload will overwrite any values set in other configuration parameters. See the <a href="https://docs.extrahop.com/current/rest-api-guide/" target="_blank">ExtraHop REST API Guide</a> for formatting guidelines. In JSON object, 'from', 'until', 'limit' and 'offset' parameters will not be considered as they are internally managed by the on-poll action.
		</li>
	</ul>
	<h2><b>Detection settings</b><br></h2>
	For detection, while manual polling and in the <b>first run</b> of scheduled/interval polling, it will retrieve the data from past one hour.
	<ul>
		<li>
			<b>Detection category: </b> Specify the category of detections you want to retrieve. If left blank, the poll retrieves detections from all categories. The following are the valid values that the parameter can take:
			<ul>
				<li>sec</li>
				<li>sec.action</li>
				<li>sec.botnet</li>
				<li>sec.caution</li>
				<li>sec.command</li>
				<li>sec.cryptomining</li>
				<li>sec.dos</li>
				<li>sec.exfil</li>
				<li>sec.exploit</li>
				<li>sec.hardening</li>
				<li>sec.ransomware</li>
				<li>sec.recon</li>
				<li>perf</li>
				<li>perf.auth</li>
				<li>perf.db</li>
				<li>perf.network</li>
				<li>perf.service</li>
				<li>perf.storage</li>
				<li>perf.virtual</li>
				<li>perf.web</li>
			</ul>
		</li>
		<li>
			<b>Detection status: </b>Specify the status of the detections you want to retrieve. Specify a comma-delimited list to poll for more than one status. If left blank, the poll retrieves detections of any status. The following are the valid values that the parameter can take:
			<ul>
				<li>new</li>
				<li>in_progress</li>
				<li>closed</li>
				<li>acknowledged</li>
			</ul>
		</li>
	</ul>
	<h2><b>Metric settings</b><br></h2>
	For metric, while manual polling and in the <b>first run</b> of scheduled/interval polling, it will retrieve the data from past one hour.
	<ul>
		<li>
			<b>Aggregation interval: </b>Specify the aggregation, or roll-up, time interval for the metric cycle. The default value is 'auto' which will retrieve the data according to time decided by api. The following are the valid values that the parameter can take:
			<ul>
				<li>auto</li>
				<li>30 seconds</li>
				<li>5 minutes</li>
				<li>1 hour</li>
			</ul>
		</li>
		<li>
			<b>Object ID: </b>Specify the comma-delimited IDs of the objects that you want to poll for metrics.<br>
		</li>
		<li>
			<b>Object type: </b>Specify the type of object. The default value is 'Applications' which will retrieve the data of Apllication object type. The following are the valid values that the parameter can take:<br>
			<ul>
				<li>Applications</li>
				<li>Device</li>
				<li>Device Groups</li>
				<li>Device Group Summary</li>
				<li>Network</li>
			</ul>
		</li>
		<li>
			<b>Metrics category: </b>Specify the category of the metrics you want to retrieve, such as "http" or "dns_server". To find the category of a metric, open the Metric Catalog from the ExtraHop system. The category is displayed in the REST API Parameters section for each metric.
		</li>
		<li>
			<b> Metrics name: </b>Specify the comma-delimited names of a metric you want to retrieve. To find the name of a metric, open the Metric Catalog from the ExtraHop system. The name is displayed in the REST API Parameters section for the metric.
		</li>
	</ul>
	<h2><b>PCAP settings</b><br></h2>
	For PCAP, while manual polling and in the <b>first run</b> of scheduled/interval polling, it will retrieve the data from past one hour. The packets will only be ingested in the <b>pcap</b> file format.
	<ul>
		<li>
			<b>BPF: </b>Specify the Berkeley Packet Filter syntax you want to apply to the poll.
			For more information about <a href="https://docs.extrahop.com/8.9/bpf-syntax/" target="_blank">BPF syntax</a>.<br>
		</li>
		<li>
			<b>Maximum bytes: </b>Specify the maximum number of bytes that the poll can return when retrieving packets.
		</li>
		<li>
			<b>Maximum search time: </b>Specify the maximum amount of time that the poll can run when retrieving packets. The default unit is milliseconds, but other units can be specified with a unit suffix.<br>
		</li>
		<li>
			<b>IP address: </b>Specify the IP address sending or receiving packets that you want to retrieve. You can also specify a second IP address.<br>
		</li>
		<li>
			<b>Port: </b>Specify the port sending or receiving packets that you want to retrieve. You can also specify a second port.<br>
		</li>
	</ul>
	<h2>Asset polling</h2>
		<p>Polling is the process of retrieving data from an asset and ingesting it into Splunk SOAR. The parameters specified on the Asset Settings tab of the app determine what data is retrieved.</p>
		<p>You can initiate polling manually, on a schedule, or by interval from the Ingest Settings tab on the app.</p>
		<p>Data is stored in the form of containers and artifacts. A container is a structured JSON object on which playbook automation APIs are run. An artifact is a JSON object stored in a container and represents an incident, activity, data, or other item associated with a container. You can add a label to a container to describe the contents. For example, you might label a container for a type of detection that contains artifacts for each occurence of the detection type.</p>
	<h2>Playbook Backward Compatibility</h2>
	<p>
		<ul>
			<li>The parameters have been added in the below-existing action. Hence, it is requested to update existing playbooks created in the earlier versions of the app by re-inserting | modifying | deleting the corresponding action blocks.</li>
			<ul>
				<li>Get devices - Below parameter have been added or updated.</li>
				<ul>
					<li>'json object'</li>
					<li>'filter'</li>
					<li>Updated name from 'activity type' to 'field type'</li>
				</ul>
				<li>Create Device - Below parameter have been added.</li>
				<ul>
					<li>'json object'</li>
				</ul>
			</ul>
		</ul>
	</p>
</body>
</html>
