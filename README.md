[comment]: # "Auto-generated SOAR connector documentation"
# ExtraHop Reveal\(x\)

Publisher: Splunk  
Connector Version: 2\.1\.0  
Product Vendor: ExtraHop Networks  
Product Name: ExtraHop Reveal\(x\)  
Product Version Supported (regex): "\.\*"  
Minimum Product Version: 5\.3\.4  

This app integrates with your ExtraHop system to gain insight into devices, traffic, and detections in your environment

[comment]: # "File: README.md"
[comment]: # "Copyright (c) 2018-2022 Splunk Inc."
[comment]: # ""
[comment]: # "Licensed under the Apache License, Version 2.0 (the 'License');"
[comment]: # "you may not use this file except in compliance with the License."
[comment]: # "You may obtain a copy of the License at"
[comment]: # ""
[comment]: # "    http://www.apache.org/licenses/LICENSE-2.0"
[comment]: # ""
[comment]: # "Unless required by applicable law or agreed to in writing, software distributed under"
[comment]: # "the License is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,"
[comment]: # "either express or implied. See the License for the specific language governing permissions"
[comment]: # "and limitations under the License."
[comment]: # ""
# Integrate ExtraHop Reveal(x)

The Splunk SOAR integration for ExtraHop enables you to automate and orchestrate rapid security
investigation, response, and remediation workflows. ExtraHop Reveal(x) provides a uniquely rich,
real-time data source by turning unstructured packets into structured wire data and analyzing it in
real-time. Based on this data, you can confidently configure Splunk SOAR to automate security
workflows and investigations and orchestrate precise, rapid responses to security threats more
effectively than ever before.

Extrahop and Splunk SOAR connect through simple, powerful REST APIs, making it easy to build and
iterate new use cases to get the most value for the least effort, a vital capability for thinly
stretched enterprise security teams.

-   To integrate ExtraHop Reveal(x) 360, you must first [generate a client ID and client
    secret](https://docs.extrahop.com/current/rx360-integrations-splunk-soar/) from the ExtraHop
    system, and then configure an asset in the ExtraHop App for Splunk SOAR.
-   To integrate ExtraHop Reveal(x) Enterprise, you must first [generate a REST API
    key](https://docs.extrahop.com/current/rest-api-guide/#generate-an-api-key) from the ExtraHop
    system, and then configure an asset in the ExtraHop App for Splunk SOAR.

# Asset settings

The Asset Settings tab of the app enables you to specify settings for integrating Splunk SOAR with
ExtraHop Reveal(x) and to configure the type of ExtraHop data you want to poll.

## Integration settings

-   **Type of asset:** Specify the type of ExtraHop system to be polled. The following are the valid
    values that the parameter can take:  
    -   Reveal(x) Enterprise
    -   Reveal(x) 360
-   **IP address or hostname:** Specify the IP address or hostname of the ExtraHop system to be
    polled. Specify an IP address or hostname for a Reveal(x) Enterprise sensor or console. Specify
    a hostname for a Reveal(x) 360 console.
-   **REST API Key:** Specify the REST API Key generated by the ExtraHop system. This key is only
    required for Reveal(x) Enterprise.
-   **Client ID:** Specify a client ID. This ID is only required for integrating with Reveal(x) 360.
-   **Client secret:** Specify a client secret. This secret is only required for integrating with
    Reveal(x) 360.
-   **Verify server certificate:** Select to verify the server certificate on the ExtraHop system.
-   **Type of data to retrieve and ingest:** Specify the type of data to be retrieved and ingested
    while polling. The default value is 'Detections'. The following are the valid values that the
    parameter can take:
    -   Detections
    -   Metrics
    -   PCAP
-   **JSON object for on poll:** Specify a JSON request payload to retrieve more data than offered
    by the current parameters. Contents of the JSON payload will overwrite any values set in other
    configuration parameters. See the [ExtraHop REST API
    Guide](https://docs.extrahop.com/current/rest-api-guide/) for formatting guidelines. In JSON
    object, 'from', 'until', 'limit' and 'offset' parameters will not be considered as they are
    internally managed by the on-poll action.

## **Detection settings** 

For detection, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from past one hour.

-   **Detection category:** Specify the category of detections you want to retrieve. If left blank,
    the poll retrieves detections from all categories. The following are the valid values that the
    parameter can take:
    -   sec
    -   sec.action
    -   sec.botnet
    -   sec.caution
    -   sec.command
    -   sec.cryptomining
    -   sec.dos
    -   sec.exfil
    -   sec.exploit
    -   sec.hardening
    -   sec.ransomware
    -   sec.recon
    -   perf
    -   perf.auth
    -   perf.db
    -   perf.network
    -   perf.service
    -   perf.storage
    -   perf.virtual
    -   perf.web
-   **Detection status:** Specify the status of the detections you want to retrieve. Specify a
    comma-delimited list to poll for more than one status. If left blank, the poll retrieves
    detections of any status. The following are the valid values that the parameter can take:
    -   new
    -   in_progress
    -   closed
    -   acknowledged

## **Metric settings** 

For metric, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from past one hour.

-   **Aggregation interval:** Specify the aggregation, or roll-up, time interval for the metric
    cycle. The default value is 'auto' which will retrieve the data according to time decided by
    api. The following are the valid values that the parameter can take:
    -   auto
    -   30 seconds
    -   5 minutes
    -   1 hour
-   **Object ID:** Specify the comma-delimited IDs of the objects that you want to poll for
    metrics.  
-   **Object type:** Specify the type of object. The default value is 'Applications' which will
    retrieve the data of Apllication object type. The following are the valid values that the
    parameter can take:  
    -   Applications
    -   Device
    -   Device Groups
    -   Device Group Summary
    -   Network
-   **Metrics category:** Specify the category of the metrics you want to retrieve, such as "http"
    or "dns_server". To find the category of a metric, open the Metric Catalog from the ExtraHop
    system. The category is displayed in the REST API Parameters section for each metric.
-   **Metrics name:** Specify the comma-delimited names of a metric you want to retrieve. To find
    the name of a metric, open the Metric Catalog from the ExtraHop system. The name is displayed in
    the REST API Parameters section for the metric.

## **PCAP settings** 

For PCAP, while manual polling and in the **first run** of scheduled/interval polling, it will
retrieve the data from past one hour. The packets will only be ingested in the **pcap** file format.

-   **BPF:** Specify the Berkeley Packet Filter syntax you want to apply to the poll. For more
    information about [BPF syntax](https://docs.extrahop.com/8.9/bpf-syntax/) .  
-   **Maximum bytes:** Specify the maximum number of bytes that the poll can return when retrieving
    packets.
-   **Maximum search time:** Specify the maximum amount of time that the poll can run when
    retrieving packets. The default unit is milliseconds, but other units can be specified with a
    unit suffix.  
-   **IP address:** Specify the IP address sending or receiving packets that you want to retrieve.
    You can also specify a second IP address.  
-   **Port:** Specify the port sending or receiving packets that you want to retrieve. You can also
    specify a second port.  

## Asset polling

Polling is the process of retrieving data from an asset and ingesting it into Splunk SOAR. The
parameters specified on the Asset Settings tab of the app determine what data is retrieved.

You can initiate polling manually, on a schedule, or by interval from the Ingest Settings tab on the
app.

Data is stored in the form of containers and artifacts. A container is a structured JSON object on
which playbook automation APIs are run. An artifact is a JSON object stored in a container and
represents an incident, activity, data, or other item associated with a container. You can add a
label to a container to describe the contents. For example, you might label a container for a type
of detection that contains artifacts for each occurence of the detection type.

## Playbook Backward Compatibility

-   The parameters have been added in the below-existing action. Hence, it is requested to update
    existing playbooks created in the earlier versions of the app by re-inserting \| modifying \|
    deleting the corresponding action blocks.

      

    -   Get devices - Below parameter have been added or updated.

          

        -   'json object'
        -   'filter'
        -   Updated name from 'activity type' to 'field type'

    -   Create Device - Below parameter have been added.

          

        -   'json object'


### Configuration Variables
The below configuration variables are required for this Connector to operate.  These variables are specified when configuring a ExtraHop Reveal\(x\) asset in SOAR.

VARIABLE | REQUIRED | TYPE | DESCRIPTION
-------- | -------- | ---- | -----------
**instance\_type** |  required  | string | Type of asset
**base\_url** |  required  | string | IP address or hostname
**api\_key** |  optional  | password | REST API key \(Reveal\(x\) Enterprise only\)
**verify\_server\_cert** |  optional  | boolean | Verify server certificate
**client\_id** |  optional  | string | Client ID \(Reveal\(x\) 360 only\)
**client\_secret** |  optional  | password | Client secret \(Reveal\(x\) 360 only\)
**ingestion\_type** |  optional  | string | Type of data to retrieve and ingest
**json\_object** |  optional  | string | JSON object for on poll action
**detection\_category** |  optional  | string | Category of detections to retrieve\. \(Leave blank to retrieve detections in any category\)
**detection\_status** |  optional  | string | Status of detections to retrieve\. \(Comma\-delimited; leave blank to retrieve detections of any status
**metric\_cycle\_length** |  optional  | string | Aggregation time interval for retrieved metrics
**object\_type** |  optional  | string | Object type associated with the API IDs to poll for metrics
**object\_id** |  optional  | string | API IDs for the objects to poll for metrics \(Comma\-delimited\)
**metric\_category** |  optional  | string | Category of metrics to retrieve\. \(See REST API Parameters in the ExtraHop Metric Catalog to find categories\)
**metric\_name** |  optional  | string | Names of metrics to retrieve\. \(Comma\-delimited; see REST API Parameters in the ExtraHop Metric Catalog to find metric names\)
**bpf** |  optional  | string | Berkeley Packet Filter \(BPF\) syntax for packet retrieval
**limit\_bytes** |  optional  | string | Maximum number of return bytes for packet retrieval
**limit\_search\_duration** |  optional  | string | Maximum runtime for packet retrieval\. The default unit is milliseconds, but other units can be specified with a unit suffix\.
**ip1** |  optional  | string | Retrieve packets sent to or received by this IP address
**ip2** |  optional  | string | Retrieve packets sent to or received by this additional IP address
**port1** |  optional  | numeric | Retrieve packets sent to or received by this port number
**port2** |  optional  | numeric | Retrieve packets sent to or received by this additional port number

### Supported Actions  
[test connectivity](#action-test-connectivity) - Initiate a connection to the ExtraHop system to validate the asset configuration  
[get device info](#action-get-device-info) - Retrieve details and properties for a device  
[get peers](#action-get-peers) - Retrieve a list of peers that communicated with a device  
[get protocols](#action-get-protocols) - Retrieve a list of protocols observed on a device  
[get devices](#action-get-devices) - Retrieve a list of devices based on specified search criteria  
[create device](#action-create-device) - Create a custom device \(Reveal\(x\) Enterprise only\)  
[tag device](#action-tag-device) - Tag an existing device  
[get metrics](#action-get-metrics) - Retrieve the metrics data  
[get packets](#action-get-packets) - Retrieve the packets data  
[on poll](#action-on-poll) - Retrieve and ingest of data from the ExtraHop system  

## action: 'test connectivity'
Initiate a connection to the ExtraHop system to validate the asset configuration

Type: **test**  
Read only: **True**

#### Action Parameters
No parameters are required for this action

#### Action Output
No Output  

## action: 'get device info'
Retrieve details and properties for a device

Type: **investigate**  
Read only: **True**

This action retrieves details about a specified device on the ExtraHop network such as MAC address, DHCP name, discovery time, device role, and device group membership\. Learn more about <a href='https\://docs\.extrahop\.com/current/rest\-search\-for\-device/' target='\_blank'>retrieving device information through the ExtraHop REST API</a>\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**ip** |  required  | Comma\-delimited list of device IP addresses to retrieve details and properties | string |  `ip` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.ip | string |  `ip` 
action\_result\.data\.\*\.analysis | string | 
action\_result\.data\.\*\.analysis\_level | numeric | 
action\_result\.data\.\*\.auto\_role | string | 
action\_result\.data\.\*\.cdp\_name | string | 
action\_result\.data\.\*\.cloud\_account | string | 
action\_result\.data\.\*\.cloud\_instance\_description | string | 
action\_result\.data\.\*\.cloud\_instance\_id | string | 
action\_result\.data\.\*\.cloud\_instance\_name | string | 
action\_result\.data\.\*\.cloud\_instance\_type | string | 
action\_result\.data\.\*\.critical | boolean | 
action\_result\.data\.\*\.custom\_criticality | string | 
action\_result\.data\.\*\.custom\_make | string | 
action\_result\.data\.\*\.custom\_model | string | 
action\_result\.data\.\*\.custom\_name | string | 
action\_result\.data\.\*\.custom\_type | string | 
action\_result\.data\.\*\.default\_name | string | 
action\_result\.data\.\*\.description | string | 
action\_result\.data\.\*\.device\_class | string | 
action\_result\.data\.\*\.dhcp\_name | string |  `host name` 
action\_result\.data\.\*\.discover\_time | numeric | 
action\_result\.data\.\*\.discovery\_id | string | 
action\_result\.data\.\*\.display\_name | string | 
action\_result\.data\.\*\.dns\_name | string |  `host name` 
action\_result\.data\.\*\.extrahop\_id | string | 
action\_result\.data\.\*\.id | numeric |  `extrahop api id` 
action\_result\.data\.\*\.ipaddr4 | string |  `ip` 
action\_result\.data\.\*\.ipaddr6 | string |  `ip` 
action\_result\.data\.\*\.is\_l3 | boolean | 
action\_result\.data\.\*\.last\_seen\_time | numeric | 
action\_result\.data\.\*\.macaddr | string |  `mac address` 
action\_result\.data\.\*\.mod\_time | numeric | 
action\_result\.data\.\*\.model | string | 
action\_result\.data\.\*\.model\_override | string | 
action\_result\.data\.\*\.netbios\_name | string | 
action\_result\.data\.\*\.node\_id | numeric | 
action\_result\.data\.\*\.on\_watchlist | boolean | 
action\_result\.data\.\*\.parent\_id | numeric | 
action\_result\.data\.\*\.role | string | 
action\_result\.data\.\*\.subnet\_id | string | 
action\_result\.data\.\*\.user\_mod\_time | numeric | 
action\_result\.data\.\*\.vendor | string | 
action\_result\.data\.\*\.vlanid | numeric | 
action\_result\.data\.\*\.vpc\_id | string | 
action\_result\.summary\.device\_count | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'get peers'
Retrieve a list of peers that communicated with a device

Type: **investigate**  
Read only: **True**

This action retrieves a list of all peers that communicated with a specified device within the last N minutes\. The peers can be filtered by role and protocols\. Specify the device through either the 'ip' or 'eh\_api\_id' parameter\. If both parameters are provided, 'eh\_api\_id' is the default\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**ip** |  optional  | IP address of the device from which to search for peers | string |  `ip` 
**minutes** |  optional  | Amount of lookback data in minutes \(default is 30 mins\) | numeric | 
**peer\_role** |  optional  | Role to search for on peers | string | 
**protocol** |  optional  | Protocol to search for on peers | string | 
**eh\_api\_id** |  optional  | REST API ID of the device \(default value if 'ip' is also specified\) | numeric |  `extrahop api id` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.eh\_api\_id | numeric |  `extrahop api id` 
action\_result\.parameter\.ip | string |  `ip` 
action\_result\.parameter\.minutes | numeric | 
action\_result\.parameter\.peer\_role | string | 
action\_result\.parameter\.protocol | string | 
action\_result\.data\.\*\.analysis | string | 
action\_result\.data\.\*\.analysis\_level | numeric | 
action\_result\.data\.\*\.cdp\_name | string | 
action\_result\.data\.\*\.custom\_name | string | 
action\_result\.data\.\*\.custom\_type | string | 
action\_result\.data\.\*\.default\_name | string | 
action\_result\.data\.\*\.description | string | 
action\_result\.data\.\*\.device\_class | string | 
action\_result\.data\.\*\.dhcp\_name | string |  `host name` 
action\_result\.data\.\*\.discover\_time | numeric | 
action\_result\.data\.\*\.discovery\_id | string | 
action\_result\.data\.\*\.display\_name | string | 
action\_result\.data\.\*\.dns\_name | string |  `host name` 
action\_result\.data\.\*\.extrahop\_id | string | 
action\_result\.data\.\*\.id | numeric |  `extrahop api id` 
action\_result\.data\.\*\.ipaddr4 | string |  `ip` 
action\_result\.data\.\*\.ipaddr6 | string |  `ip` 
action\_result\.data\.\*\.is\_l3 | boolean | 
action\_result\.data\.\*\.macaddr | string |  `mac address` 
action\_result\.data\.\*\.mod\_time | numeric | 
action\_result\.data\.\*\.netbios\_name | string | 
action\_result\.data\.\*\.node\_id | numeric | 
action\_result\.data\.\*\.on\_watchlist | boolean | 
action\_result\.data\.\*\.parent\_id | numeric | 
action\_result\.data\.\*\.user\_mod\_time | numeric | 
action\_result\.data\.\*\.vendor | string | 
action\_result\.data\.\*\.vlanid | numeric | 
action\_result\.summary\.peer\_count | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'get protocols'
Retrieve a list of protocols observed on a device

Type: **investigate**  
Read only: **True**

This action retrieves a list of all protocols that were observed to have communicated on a specified device within the last N minutes\. Specify the device through either the 'ip' or 'eh\_api\_id' parameter\. If both parameters are provided, 'eh\_api\_id' is the default\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**ip** |  optional  | IP address of the device on which to search for protocols | string |  `ip` 
**minutes** |  optional  | Amount of lookback data in minutes \(default is 30 mins\) | numeric | 
**eh\_api\_id** |  optional  | REST API ID of the device \(default value if 'ip' is also specified\) | numeric |  `extrahop api id` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.eh\_api\_id | numeric |  `extrahop api id` 
action\_result\.parameter\.ip | string |  `ip` 
action\_result\.parameter\.minutes | numeric | 
action\_result\.data\.\*\.client\_protocols | string | 
action\_result\.data\.\*\.server\_protocols | string | 
action\_result\.summary\.client\_protocol\_count | numeric | 
action\_result\.summary\.server\_protocol\_count | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'get devices'
Retrieve a list of devices based on specified search criteria

Type: **investigate**  
Read only: **True**

This action retrieves a list of active devices that were discovered on the ExtraHop network within the last N minutes\. The 'filter' parameter is applicable only if the value for 'field\_type' is set to 'custom\_filter'\. Learn more about <a href='https\://docs\.extrahop\.com/current/rest\-extract\-devices/' target='\_blank'>extracting a device list through the ExtraHop REST API</a>\. If 'json\_object' parameter is provided, it will be prioritized and rest of the parameters will be ignored\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**json\_object** |  optional  | Json object for get device | string | 
**field\_type** |  optional  | Type of search criteria | string | 
**minutes** |  optional  | Amount of lookback data in minutes \(default is 30 mins\) | numeric | 
**offset** |  optional  | Starting count for the set of results \(default is 0\) | numeric | 
**limit** |  optional  | Maximum number of results that can be retrieved | numeric | 
**filter** |  optional  | JSON query of device search criteria | string | 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.field\_type | string | 
action\_result\.parameter\.filter | string | 
action\_result\.parameter\.json\_object | string | 
action\_result\.parameter\.limit | numeric | 
action\_result\.parameter\.minutes | numeric | 
action\_result\.parameter\.offset | numeric | 
action\_result\.data\.\*\.analysis | string | 
action\_result\.data\.\*\.analysis\_level | numeric | 
action\_result\.data\.\*\.auto\_role | string | 
action\_result\.data\.\*\.cdp\_name | string | 
action\_result\.data\.\*\.cloud\_account | string | 
action\_result\.data\.\*\.cloud\_instance\_description | string | 
action\_result\.data\.\*\.cloud\_instance\_id | string | 
action\_result\.data\.\*\.cloud\_instance\_name | string | 
action\_result\.data\.\*\.cloud\_instance\_type | string | 
action\_result\.data\.\*\.critical | boolean | 
action\_result\.data\.\*\.custom\_criticality | string | 
action\_result\.data\.\*\.custom\_make | string | 
action\_result\.data\.\*\.custom\_model | string | 
action\_result\.data\.\*\.custom\_name | string | 
action\_result\.data\.\*\.custom\_type | string | 
action\_result\.data\.\*\.default\_name | string | 
action\_result\.data\.\*\.description | string | 
action\_result\.data\.\*\.device\_class | string | 
action\_result\.data\.\*\.dhcp\_name | string |  `host name` 
action\_result\.data\.\*\.discover\_time | numeric | 
action\_result\.data\.\*\.discovery\_id | string | 
action\_result\.data\.\*\.display\_name | string | 
action\_result\.data\.\*\.dns\_name | string |  `host name` 
action\_result\.data\.\*\.extrahop\_id | string | 
action\_result\.data\.\*\.id | numeric |  `extrahop api id` 
action\_result\.data\.\*\.ipaddr4 | string |  `ip` 
action\_result\.data\.\*\.ipaddr6 | string |  `ip` 
action\_result\.data\.\*\.is\_l3 | boolean | 
action\_result\.data\.\*\.last\_seen\_time | numeric | 
action\_result\.data\.\*\.macaddr | string |  `mac address` 
action\_result\.data\.\*\.mod\_time | numeric | 
action\_result\.data\.\*\.model | string | 
action\_result\.data\.\*\.model\_override | string | 
action\_result\.data\.\*\.netbios\_name | string | 
action\_result\.data\.\*\.node\_id | numeric | 
action\_result\.data\.\*\.on\_watchlist | boolean | 
action\_result\.data\.\*\.parent\_id | numeric | 
action\_result\.data\.\*\.role | string | 
action\_result\.data\.\*\.subnet\_id | string | 
action\_result\.data\.\*\.user\_mod\_time | numeric | 
action\_result\.data\.\*\.vendor | string | 
action\_result\.data\.\*\.vlanid | numeric | 
action\_result\.data\.\*\.vpc\_id | string | 
action\_result\.summary\.active\_devices\_count | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'create device'
Create a custom device \(Reveal\(x\) Enterprise only\)

Type: **generic**  
Read only: **False**

This action creates a new custom device on the ExtraHop system from a specified IP address and CIDR block\. Learn more about <a href='https\://docs\.extrahop\.com/current/rest\-create\-custom\-devices/' target='\_blank'>creating a custom device through the ExtraHop REST API</a>\. If 'json\_object' parameter is provided, it will be prioritized and rest of the parameters will be ignored\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**json\_object** |  optional  | Json object for creating a custom device | string | 
**ip** |  optional  | IP address for the custom device | string |  `ip` 
**name** |  optional  | Unique name for the custom device | string | 
**author** |  optional  | User that created the custom device | string | 
**description** |  optional  | Description details for the custom device | string | 
**cidr** |  optional  | CIDR block for the custom device | string | 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.author | string | 
action\_result\.parameter\.cidr | string | 
action\_result\.parameter\.description | string | 
action\_result\.parameter\.ip | string |  `ip` 
action\_result\.parameter\.json\_object | string | 
action\_result\.parameter\.name | string | 
action\_result\.data\.\*\.cidr | string | 
action\_result\.data\.\*\.name | string | 
action\_result\.summary\.name | string | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'tag device'
Tag an existing device

Type: **generic**  
Read only: **False**

This action assigns tags to a device on the ExtraHop system\. Specify the device through either the 'ip' or 'eh\_api\_id' parameter\. If both parameters are provided, 'eh\_api\_id' is the default\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**ip** |  optional  | IP address of the device to tag | string |  `ip` 
**tag** |  required  | Name of the tag | string | 
**eh\_api\_id** |  optional  | REST API ID of the device \(default value if 'ip' is also specified | numeric |  `extrahop api id` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.eh\_api\_id | numeric |  `extrahop api id` 
action\_result\.parameter\.ip | string |  `ip` 
action\_result\.parameter\.tag | string | 
action\_result\.data\.\*\.tag\_id | numeric | 
action\_result\.summary\.extrahop\_device\_id | numeric | 
action\_result\.summary\.tag | string | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'get metrics'
Retrieve the metrics data

Type: **investigate**  
Read only: **True**

This action will retrieve the details of the metric based on the given inputs\. If 'json\_object' parameter is provided, it will be prioritized and rest of the parameters will be ignored\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**json\_object** |  optional  | JSON object for get metrics action | string | 
**minutes** |  optional  | Amount of lookback data in minutes \(default is 30 mins\) | numeric | 
**metric\_cycle\_length** |  optional  | Aggregation time interval for retrieved metrics | string | 
**object\_type** |  optional  | Object type associated with the API IDs | string | 
**object\_id** |  optional  | API IDs for the objects \(Comma\-delimited\) | string |  `extrahop api id` 
**metric\_category** |  optional  | Category of metrics to retrieve\. \(See REST API Parameters in the ExtraHop Metric Catalog to find categories\) | string | 
**metric\_name** |  optional  | Names of metrics to retrieve\. \(Comma\-delimited; see REST API Parameters in the ExtraHop Metric Catalog to find metric names\) | string | 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.json\_object | string | 
action\_result\.parameter\.metric\_category | string | 
action\_result\.parameter\.metric\_cycle\_length | string | 
action\_result\.parameter\.metric\_name | string | 
action\_result\.parameter\.minutes | numeric | 
action\_result\.parameter\.object\_id | string |  `extrahop api id` 
action\_result\.parameter\.object\_type | string | 
action\_result\.data\.\*\.cycle | string | 
action\_result\.data\.\*\.detail | string | 
action\_result\.data\.\*\.metric\_category | string | 
action\_result\.data\.\*\.object\_type | string | 
action\_result\.data\.\*\.oid | string |  `extrahop api id` 
action\_result\.data\.\*\.time | numeric | 
action\_result\.summary | string | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'get packets'
Retrieve the packets data

Type: **investigate**  
Read only: **True**

This action will retrieve the packets in the form of a pcap file and stored it into the vault\. If 'json\_object' parameter is provided, it will be prioritized and rest of the parameters will be ignored\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**json\_object** |  optional  | JSON object for get packets action | string | 
**minutes** |  optional  | Amount of lookback data in minutes \(default is 30 mins\) | numeric | 
**bpf** |  optional  | Berkeley Packet Filter \(BPF\) syntax for packet retrieval | string | 
**limit\_bytes** |  optional  | Maximum number of return bytes for packet retrieval | string | 
**limit\_search\_duration** |  optional  | Maximum runtime for packet retrieval\. The default unit is milliseconds, but other units can be specified with a unit suffix\. | string | 
**ip1** |  optional  | Retrieve packets sent to or received by this IP address | string |  `ip` 
**ip2** |  optional  | Retrieve packets sent to or received by this additional IP address | string |  `ip` 
**port1** |  optional  | Retrieve packets sent to or received by this port number | numeric | 
**port2** |  optional  | Retrieve packets sent to or received by this additional port number | numeric | 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.bpf | string | 
action\_result\.parameter\.ip1 | string |  `ip` 
action\_result\.parameter\.ip2 | string |  `ip` 
action\_result\.parameter\.json\_object | string | 
action\_result\.parameter\.limit\_bytes | string | 
action\_result\.parameter\.limit\_search\_duration | string | 
action\_result\.parameter\.minutes | numeric | 
action\_result\.parameter\.port1 | numeric | 
action\_result\.parameter\.port2 | numeric | 
action\_result\.data\.\*\.file\_name | string | 
action\_result\.data\.\*\.vault\_id | string |  `vault id` 
action\_result\.summary | string | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric |   

## action: 'on poll'
Retrieve and ingest of data from the ExtraHop system

Type: **ingest**  
Read only: **True**

This action ingests detections, metrics, or PCAP data from the ExtraHop system as specified by the asset configuration\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**container\_count** |  optional  | Maximum number of containers to ingest | numeric | 
**start\_time** |  optional  | Parameter ignored in this app | numeric | 
**end\_time** |  optional  | Parameter ignored in this app | numeric | 
**artifact\_count** |  optional  | Parameter ignored in this app | numeric | 

#### Action Output
No Output